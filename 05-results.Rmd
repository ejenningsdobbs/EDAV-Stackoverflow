# Results

```{r, message=FALSE, include=FALSE}
library(tidyverse)
library(remotes)
library(GGally)
library(parcoords)
library(htmlwidgets)
library(d3r)
library(MASS)
library(treemap)
library(vcd)
library(ggmosaic)
library(lubridate)
library(ggalluvial)
library(gridExtra)
library(RColorBrewer)
library(ggridges)
library(rcartocolor)
```

## Correlation Between Variables



```{r, message=FALSE}
df1_count <- df1 %>%
  group_by(year, Tags) %>%
  summarise(TotalViews = sum(ViewCount), TagCount = length(Tags), TotalComments = sum(CommentCount), AcceptedAnswers = sum(as.integer(as.character(AcceptAnswer))), TotalAnswers = sum(AnswerCount)) 

df1_count <- df1_count %>%
  group_by(year) %>%
  mutate(TagRank = as.factor(rank(-TagCount, ties.method = "first")))
```

```{r, message=FALSE}
initial_rank <- df1_count %>% filter(year==2015) %>% dplyr::select(Tags, TagRank)
initial_rank <- initial_rank %>% rename(InitialRank = TagRank)
initial_rank <- initial_rank[,2:3] 

df1_count <- left_join(df1_count, initial_rank) %>%
  mutate(InitialRank = cut(as.numeric(InitialRank), breaks = seq(0,75,5), right = F))
```

```{r, fig.height=8, fig.width=20, message=FALSE, warning=FALSE}
p <- ggpairs(df1_count %>% dplyr::select(year, TotalViews,TagCount,TotalComments, AcceptedAnswers,TotalAnswers), columns = 2:6, aes(color=year), title = "Interactions Between Continuous Variables") + 
  theme_bw() +
  theme_update(text = element_text(size=15))


#scale colors
for(i in 1:p$nrow) {
  for(j in 1:p$ncol){
    p[i,j] <- p[i,j] + 
        scale_fill_manual(values=rev(c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D"))) +
        scale_color_manual(values=rev(c("#1B9E77", "#D95F02", "#7570B3", "#E7298A", "#66A61E", "#E6AB02", "#A6761D")))  
  }
}

p
```

The variables TagCount, TotalComments, AcceptedAnswers, and TotalAnswers are all heavily correlated. To measure the success or popularity of each tag over time we are going to have to rely on one of these variables rather than a mixture of the four of them.

Each of these four variables are also to a lesser extent positively correlated with the total views each tag receives. This may be due to minimal interactions to the post after the initial answers and comments come in. Logically it is unlikely that any one question has an infinite amount of answers, after a few reasonable answers are posted to a question there may be diminishing returns.  


```{r}
grid.arrange(
df1_count %>%
  dplyr::select(year, TotalComments, AcceptedAnswers, TotalAnswers) %>% 
  group_by(year) %>% 
  summarise_all(sum) %>%
  gather("Type","Value",-year) %>%
  ggplot(aes(year, Value, fill = Type)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual("legend", values = c("TotalComments" = "#0072B2", "AcceptedAnswers" = "#D55E00", "TotalAnswers" = "#CC79A7")) +
  theme_bw() +
  ggtitle("Sum of Variables by Year"),
df1_count %>%
  dplyr::select(year, TotalViews) %>% 
  group_by(year) %>% 
  summarise_all(sum) %>%
  gather("Type","Value",-year) %>%
  ggplot(aes(year, Value, fill = Type)) +
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual("legend", values = c("TotalViews" = "#E69F00")) +
  theme_bw(),ncol=1)
#It appears views accumulate over time, total popularity/usage of tag may have to be computed overall. Current usage of Tag not reflected in views. Answers accumulate over time to a lesser degree. AcceptedAnswers seem to be pretty stable but haven't had time to fully accumulate for past 2 years.
```
It appears that views accumulate over time, this measure will not give us an accurate depiction of a tags popularity in any given year but may be telling of which tag is most popular overall. Answers and comments accumulate over time to a lesser degree and are also likely to give a skewed definition of yearly popularity. The number of accepted answers for each tag are a little more stable over time, though there is a slightly smaller amount of accepted answers in the past year which may be related to the amount of time a question is up before being answered and then having that answer marked as accepted.  

## Relationship between Views and Answers
```{r}
df1_count %>%
  group_by(Tags) %>%
  ggplot(aes(TotalViews, TotalAnswers)) +
  geom_hex() + 
  ggtitle("Total Views vs Total Answers") +
  xlab("Total Views") + 
  ylab("Total Answers")
```


For tags with less than 5,000 answers, as the total number of views per tag increases, the total number of answers provided tend to increase as well, with an exception of a tag having about 5 million views but less than 1250 answers, which may be an outlier tag. This suggests that the more view a tag has, the more answers it is likely to have. Also, many of the tags have relatively low views and few answers. 

For tags that have more than 5,000 answers, the amount of views vary from lowest to greatest, suggesting little to no correlation between the number of views a tag in this group has and number of answers it has received.


## Usage over Time


```{r, fig.height=25, fig.width=30}



  
ggplot(df1_count,
       aes(x = year, stratum = TagRank, alluvium = Tags,
           fill = InitialRank, label = Tags)) +
  scale_fill_manual(values = rev(c("#6D5BAE", "#5F6EB5", "#4F7EBA", "#3F8DBD", "#329BBE", "#2FA7BE", "#38B2BE", "#49BCBC", "#5DC6BB", "#72CEB9", "#87D5B8", "#9BDCB8", "#AEE1B9", "#BFE5BA", "#CEE8BB")))+
  scale_x_discrete(expand = c(0, 0)) +
  scale_y_discrete(expand = c(0, 0)) +
  geom_flow(stat = "alluvium", lode.guidance = "frontback",
            color = "darkgray") +
  geom_stratum(width = 3/7) +
  geom_text(stat = "alluvium", aes(label = after_stat(alluvium)), size=8) +
  theme(legend.position = "bottom", axis.text = element_text(size = 15, face = "bold")) +
  ggtitle("Frequency of Tags by Year") 

```

If tags are ordered by the frequency of occurrences in our sample per year, there is a clear difference in the usage of each tag. 


```{r,fig.height=10, fig.width=20}
treemap(df1_count, index = c("year", "Tags"), vSize = "TagCount", title = "Frequency of Tags")
treemap(df1_count, index = c("year", "Tags"), vSize = "AcceptedAnswers", title = "Frequency of Accepted Answers" )
#nearly identical but with notable differences; python and javascript always have a large proportion 
```

These two treemaps while very similar, emphasize that the amount of accepted answers in 2021 (and 2020 to a lesser extent) is much smaller than would be expected from the overall number of tags recorded. Aside from that we see that the distribution of accepted answers for each tag and frequency of each tag is practically identical.  


```{r, fig.height=15}
year2015 <- df1_count %>%
  group_by(Tags) %>%
  filter(year == 2020) %>%
  mutate(diff2015 = TagCount) %>%
  dplyr::select(Tags, diff2015, TagCount)

year2020 <- df1_count %>%
  group_by(Tags) %>%
  filter(year == 2015) %>%
  mutate(diff2020 = TagCount) %>%
  dplyr::select(Tags, diff2020, TagCount)

increase <- full_join(year2015, year2020, "Tags")  %>%
  group_by(Tags) %>%
  mutate(diff = diff2020 - diff2015) %>%
  mutate(increased = ifelse(diff > 0, 1, 0)) %>%
  dplyr::select(Tags, increased)

df1_count_sub <- df1_count %>%
  filter(year %in% c(2015,2020))

df1_count_sub <- left_join(df1_count_sub, increase, "Tags")
highlight <- filter(df1_count_sub, increased == 0)


df1_count_sub %>%
  ggplot(aes(TagCount, fct_reorder(Tags, TagCount))) +
    geom_point(aes(color = year), alpha = 0.3) +
    geom_line(aes(group = Tags), alpha = 0.3) +
    geom_line(data = highlight, aes(group = Tags)) +
    geom_point(data = highlight, aes(color = year)) +
    ggtitle('Tag Counts in 2015 vs 2020') +
    xlab('Tag Count') +
    ylab('') +
    theme_bw()
```


Highlighted tags are the ones with an increase from 2015 to 2020.

From year 2015 to 2020, we can see python has gained a substantially large amount of interest by users based on the number of tags, and it is the only tag that has an increase in the top 12 tags with the most tag counts. Over the past five years, it seems like python has become the most popular programming language users have interacted with on StackOverflow in comparing to other languages such as javascript, java, c#, c++, which all have a decrease in the tag counts.




```{r, message=FALSE}
languages <- c("c","c#","c++","dart","java","javascript","sql","swift")
df1_count %>%
  filter(Tags %in% languages) %>%
  ggplot(aes(TotalComments, fct_reorder(Tags, TotalComments))) + 
    geom_density_ridges() + 
    ggtitle("Total Comments by Tag") +
    ylab("Programming Languages") +
    xlab("Total Comments") +
    theme_classic()
```

Based on the above Ridgeline plot, javascript, java, and c# seem to have the greatest variation in total comments from years 2015 to 2021.
